# 스켈레톤 UI(Skeleton UI) 새로고침 적용기
웹 또는 앱에서 우리는 자주 새로고침 기능을 이용합니다.  
이때 화면이 완전히 비어 있거나, 로딩 스피너만 떠 있는 경험은 사용자에게 좋지 않고,  
CLS(Cumulative Layout Shift)를 크게 저하시킬 수 있어요.  
이러한 문제를 해결하기 위해 '스켈레톤 UI(Skeleton UI)'가 등장합니다.  

스켈레톤 UI(Skeleton UI)란 데이터나 콘텐츠가 로딩상황에서 실제 데이터가 렌더링 될 화면의 윤곽이나  
뼈대를 미리 시각적으로 점유해주는 UI 입니다.  
사용자는 데이터를 기다리는 동안에도 레이아웃 구조를 인지할 수 있고, 심리적으로 더 빠르게 느끼게 됩니다.  
CLS도 기존 로딩 스피너에 비해 크게 향상 됩니다.  

스켈레톤 UI(Skeleton UI) 장점
- 페이지 이탈 방지
- 빠른 반응처럼 느껴짐
- 콘텐츠가 절달되고 있음을 시각적으로 알려줌
- CLS 향상

|렌더링 전 스켈레톤 UI|렌더링 후 실제 데이터|
|--------------------|----------------------|
|<img width="1113" height="688" alt="image" src="https://github.com/user-attachments/assets/fd282977-b4b4-4490-ac57-3913aa78149b" />|<img width="1116" height="685" alt="image" src="https://github.com/user-attachments/assets/0e1de5e6-786c-48d1-bca7-dfbfd8c23bad" />|


## 직접 사용하기
직접 스켈레톤 애니메이션을 만들 수 도 있지만 보다 쉽게 사용하기 위해 라이브러리를 사용하였습니다.    
- 라이브러리
  - React Loading Skeleton
    - [react-loading-skeleton](https://www.npmjs.com/package/react-loading-skeleton)
    - [react-loading-skeleton Github Repository](https://github.com/dvtng/react-loading-skeleton)
  - Styled Components
    - [styled-components](https://styled-components.com) 
- 테스트 데이터 API
  - fakestoreapi
    - [fakestoreapi](https://fakestoreapi.com/) 

### Skeleton 설치
```
yarn add react-loading-skeleton
npm install react-loading-skeleton
```
다음과 같이 설치하여 사용할 수 있습니다.  

코드는 다음과 같이 만들어 보았습니다.
### useFetchGetShoppingList.tsx
```tsx
import { useEffect, useState } from "react";
import ShoppingList from "../api/shoppingList";
import { ShoppingCard } from "../types/shoppingCard";

function useFetchGetShoppingList() {
  const [listData, setListData] = useState<ShoppingCard[]>([]);
  const [isLoading, setIsLoading] = useState(false);

  useEffect(() => {
    const getShoppingListData = async () => {
      if (isLoading === true) {
        return;
      }
      setIsLoading(true);
      const result = await ShoppingList.getShoppingList();
      if (result) {
        setIsLoading(false);
        setListData(result);
      }
    };
    getShoppingListData();
    // eslint-disable-next-line react-hooks/exhaustive-deps
  }, []);
  return { listData, isLoading };
}
export default useFetchGetShoppingList;

```

### ShoppingList.tsx
```tsx
import styled from "styled-components";
import Card from "./Card";

import useFetchGetShoppingList from "../hooks/useFetchGetShoppingList";
import CardSkeleton from "./CardSkeleton";

const Wrapper = styled.div`
  max-width: 1080px;
  margin: 0 auto;
  padding: 24px 16px;

  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
  gap: 20px;

  @media (max-width: 480px) {
    grid-template-columns: 1fr;
    padding: 16px 12px;
  }
`;
function ShoppingList() {
  const { listData, isLoading } = useFetchGetShoppingList();
  return (
    <Wrapper>
      {isLoading
        ? new Array(8)
            .fill(null)
            .map((_, index) => <CardSkeleton key={index} />)
        : listData.map((data) => <Card key={data.title} item={data} />)}
    </Wrapper>
  );
}

export default ShoppingList;
```

   
### Card.tsx
```tsx
function Card({ item }: CardProps) {
  return (
    <CardContainer>
      <ImageBox>
        <CardImage src={item.image} alt={item.title} />
      </ImageBox>
      <CardContent>
        <Title>{item.title}</Title>
        <Description>{item.description}</Description>
        <Price>₩ {item.price.toLocaleString()}</Price>
      </CardContent>
    </CardContainer>
  );
}

export default Card;
```

### CardSkeleton.tsx
```tsx
function CardSkeleton() {
  return (
    <CardContainer>
      <ImageBox>
        <div
          style={{
            position: "absolute",
            left: "50%",
            top: "50%",
            transform: "translate(-50%, -50%)",
          }}
        >
          <Skeleton width={190} height={120} />
        </div>
      </ImageBox>
      <CardContent>
        <Title>
          <Skeleton width={130} />
        </Title>
        <Description>
          <Skeleton width={190} count={2} />
        </Description>
        <Price>
          <Skeleton width={50} />
        </Price>
      </CardContent>
    </CardContainer>
  );
}

export default CardSkeleton;
```


https://github.com/user-attachments/assets/4cc5f1c0-ba6b-4ca2-8c66-9647531730b6  

데이터를 Fetch 해오는 동안 스켈레톤 UI를 적용시켜 보았다.  
추후에는 로딩 시 에러 처리나 Suspense 기반의 스켈레톤 처리 등으로 확장할 수 있을 것 같습니다.

